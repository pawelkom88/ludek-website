---
import type { PostQueryResponse } from "src/types/types";
import { loadAllPosts } from "src/utils/helpers";
import AboutCard from "../about-card/AboutCard.astro";
import Article from "../article/Article.astro";
import SubscriptionForm from "../subscription-form/SubscriptionForm.astro";
import ThreeLineSeparator from "../three-line-separator/ThreeLineSeparator.astro";
import "./main-grid.css";

const { lang } = Astro.props;
const data = await loadAllPosts(lang);
const [mainPost, ...otherPosts]: PostQueryResponse["posts"]["edges"] =
  data?.posts.edges || [];
const firstTwoPosts = otherPosts.slice(0, 2);
---

<section id="maincontent" class="main-grid">
  <ol class="main-grid-item">
    <li>
      <h2 class="section-title">Latest news</h2>
      <Article article={mainPost.node} />
    </li>
    <ol class="sub-grid">
      {firstTwoPosts.map((article) => <Article article={article.node} />)}
    </ol>
  </ol>
  <aside class="aside">
    <AboutCard />
    <ThreeLineSeparator />
    <SubscriptionForm />
  </aside>
</section>
<a href={`/${lang}/news/`} class="read-more">See all posts</a>
